
# –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π —Å—Ç–µ–Ω–¥ –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—é—â–∏–π –≤ —Å–µ–±—è Nginx –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, Envoy –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏ –∏ K6 –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –¢–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Prometheus –∏ Grafana.

## –ó–∞–ø—É—Å–∫, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ó–∞–ø—É—Å–∫ —Å—Ç–µ–Ω–¥–∞
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å—Ç–µ–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
./start.sh
```
–ò–ª–∏ –∫–æ–º–∞–Ω–¥—É `make`:
```bash
make start
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ (simple.test.js):
```bash
make test
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å—Ç–µ–Ω–¥–∞:
```bash
./stop.sh
```
–ò–ª–∏ –∫–æ–º–∞–Ω–¥—É `make`:
```bash
make stop
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ configs/                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ envoy.yaml             # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Envoy
‚îÇ   ‚îú‚îÄ‚îÄ envoy-*.yaml           # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îÇ   ‚îú‚îÄ‚îÄ prometheus.yml         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prometheus
‚îÇ   ‚îî‚îÄ‚îÄ healthcheck.html       # –§–∞–π–ª healthcheck
‚îú‚îÄ‚îÄ static/                    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã HTML
‚îÇ   ‚îú‚îÄ‚îÄ index.html            # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ challenge.html        # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html        # Dashboard –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ healthcheck.html      # Healthcheck —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ tests/                     # –¢–µ—Å—Ç—ã (k6)
‚îÇ   ‚îú‚îÄ‚îÄ simple.test.js        # –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ e2e/                  # End-to-end —Ç–µ—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ scenarios.js      # –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ extended-scenarios.js # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ performance.js    # –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ load-test.js      # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ unit/                 # –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ dashboard/                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Grafana
‚îÇ   ‚îú‚îÄ‚îÄ dashboards/            # –î–∞—à–±–æ—Ä–¥—ã Grafana
‚îÇ   ‚îú‚îÄ‚îÄ grafana.ini            # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Grafana
‚îÇ   ‚îî‚îÄ‚îÄ provisioning/          # –ü—Ä–æ–≤–∏–∂–∏–Ω–∏–Ω–≥ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∞—à–±–æ—Ä–¥–æ–≤
‚îú‚îÄ‚îÄ *.sh                      # –°–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îî‚îÄ‚îÄ Makefile                  # –ê–ª–∏–∞—Å—ã –∫–æ–º–∞–Ω–¥
```

## üß™ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π    | User-Agent        | –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç |
|-------------|-------------------|-----------------|
| Human       | `Mozilla/5.0`     | `200 OK`        |
| Bad Bot     | `BadBot/1.0`      | `403 Forbidden` |
| Suspicious  | `SuspiciousBot/1.0`| `302 Redirect`  |

## üõ† –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
```bash
./start.sh          # –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–Ω–¥–∞
./stop.sh           # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–µ–Ω–¥–∞
./status.sh         # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
./test.sh           # –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (simple.test.js)
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
./extended-test.sh  # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (extended-scenarios.js)
./load-test.sh      # –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (load-test.js)
./run-test.sh       # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫–∞—Ç–µ–ª—å —Ç–µ—Å—Ç–æ–≤ (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ç–µ—Å—Ç–∞)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
./monitor-info.sh           # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ (—Å—Å—ã–ª–∫–∏)
./check-metrics.sh          # –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ Prometheus
./check-metrics-detailed.sh # –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ Prometheus
./check-prometheus-query.sh # –ó–∞–ø—Ä–æ—Å—ã –∫ Prometheus API
./check-grafana-setup.sh    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Grafana
./check-nginx-metrics.sh    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ Nginx (—á–µ—Ä–µ–∑ Nginx Exporter)
./check-prometheus-metrics.sh # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –º–µ—Ç—Ä–∏–∫ Prometheus
./check-grafana.sh          # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Grafana
```

### –£—Ç–∏–ª–∏—Ç—ã
```bash
./generate-traffic.sh       # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏
./generate-more-traffic.sh  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–æ–ª—å—à–µ–≥–æ –æ–±—ä–µ–º–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
./setup-grafana-dashboard.sh # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞ Grafana (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞)
./full-test.sh             # –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (–≤–∫–ª—é—á–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –≤–∏–¥—ã —Ç–µ—Å—Ç–æ–≤)
```

### Makefile –∫–æ–º–∞–Ω–¥—ã
```bash
make start     # –ó–∞–ø—É—Å–∫ —Å—Ç–µ–Ω–¥–∞
make stop      # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–µ–Ω–¥–∞
make test      # –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (simple.test.js)
make unit      # –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã (validation.test.js)
make e2e       # End-to-end —Ç–µ—Å—Ç—ã (scenarios.js)
make perf      # –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (performance.js)
make extended  # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (extended-scenarios.js)
make load      # –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã (load-test.js)
make monitor   # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ
make logs      # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make status    # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
make clean     # –û—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Ç–æ–º–æ–≤)
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å—Ç–µ–Ω–¥–∞ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–ª–µ–¥—É—é—â–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º:

*   **üåê –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** [http://localhost:8080](http://localhost:8080)
*   **üìà Prometheus:** [http://localhost:9090](http://localhost:9090)
*   **üìä Grafana:** [http://localhost:3000](http://localhost:3000) (–ª–æ–≥–∏–Ω: `admin`, –ø–∞—Ä–æ–ª—å: `admin`)
*   **üéØ Prometheus Targets:** [http://localhost:9090/targets](http://localhost:9090/targets)
*   **üì° Node Exporter:** [http://localhost:9100](http://localhost:9100)
*   **üîß Nginx Exporter:** [http://localhost:9113](http://localhost:9113)

## üê≥ –°–µ—Ä–≤–∏—Å—ã

| –°–µ—Ä–≤–∏—Å         | –û–ø–∏—Å–∞–Ω–∏–µ                                  | –ü–æ—Ä—Ç—ã          |
|----------------|-------------------------------------------|----------------|
| `server`       | Nginx –≤–µ–±-—Å–µ—Ä–≤–µ—Ä, –æ–±—Å–ª—É–∂–∏–≤–∞—é—â–∏–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã | 80             |
| `rdu`          | Envoy reverse proxy, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ | 8080, 9901 (admin) |
| `client`       | –û–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ `k6`           | (–Ω–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö) |
| `prometheus`   | –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫                       | 9090           |
| `grafana`      | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –¥–∞—à–±–æ—Ä–¥—ã              | 3000           |
| `node-exporter`| –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä –º–µ—Ç—Ä–∏–∫ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã        | 9100           |
| `nginx-exporter`| –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä –º–µ—Ç—Ä–∏–∫ Nginx                      | 9113           |

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
*   **3 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:** `server`, `rdu`, `client`
*   **–û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞:** `./start.sh`
*   **–û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–µ—Å—Ç–æ–≤:** `make test`
*   **3 —Å—Ü–µ–Ω–∞—Ä–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:** Human, Bad Bot, Suspicious

### –ë–æ–Ω—É—Å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è:
*   **–†–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –±–æ–ª–µ–µ 7 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö User-Agent –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
*   **–¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `k6` –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ –∏ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
*   **Observability:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã Prometheus –∏ Grafana –¥–ª—è —Å–±–æ—Ä–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫.
*   **–ü—Ä–∞–≤–∏–ª–∞ reverse-proxy —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:** –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏.

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

–í—ã –º–æ–∂–µ—Ç–µ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é `curl`:

```bash
# ‚Üí 200 OK (Human)
curl -H "User-Agent: Mozilla/5.0" http://localhost:8080

# ‚Üí 403 Forbidden (Bad Bot)
curl -H "User-Agent: BadBot/1.0" http://localhost:8080

# ‚Üí 302 Redirect (Suspicious)
curl -H "User-Agent: SuspiciousBot/1.0" http://localhost:8080

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–±–æ–Ω—É—Å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ)
curl -H "User-Agent: Googlebot/2.1" http://localhost:8080 # ‚Üí 200 OK (Good Bot)
curl -H "User-Agent: AhrefsBot/7.0" http://localhost:8080 # ‚Üí 200 OK (Good Bot)
curl -H "User-Agent: SomeScanner/1.0" http://localhost:8080 # ‚Üí 403 Forbidden (Known Scanner)
curl -H "User-Agent: CustomApp/1.0" http://localhost:8080 # ‚Üí 200 OK (Default/Custom App)
```
